jQuery(document).ready(function(o){function a(){o.each({comment:"",comment_parent:"0",comment_id:"",comment_action:""},function(t,e){0<o("#commentform").find('[name="'+t+'"]').length&&("comment"===t?o("#commentform").find('[name="'+t+'"]').text(e):o("#commentform").find('[name="'+t+'"]').val(e))})}function n(){a();var t=o("#respond");o("#comments").append(t.prop("outerHTML")),t.remove()}var i=localStorage.getItem("commentStorage");function m(t){var e=o("#comments").find('.comment[data-object-hash="'+t+'"]');0!==e.length&&(e.each(function(t){if(0===o(this).find(".comment-notifications").length){var e=o("<div>",{class:"comment-notifications"});o(this).hasClass("awaiting-moderation")&&e.append('<div class="notification notification_warning">'+ajax_obj.notifications["comment-awaiting-moderation"]+"</div>"),o(this).hasClass("awaiting-confirmation")&&e.append('<div class="notification notification_warning">'+ajax_obj.notifications["comment-awaiting-confirmation"]+"</div>"),""!==e.html().trim()&&o(this).find(".comment-footer").before(e)}}),notificationButton())}"undefined"===i||null===i?i={}:"undefined"!==(i=JSON.parse(i)).comment_hash&&m(i.comment_hash),o("#comments").on("click",".comment-confirmation-resend",function(t){var e=o(this);comment=o(this).closest(".comment"),comment_id=comment.data("object-id"),e.hasClass("diactive")||o.ajax({type:"POST",url:ajax_obj.url,data:{action:"comments_confirmation_resend_action","comment-id":comment_id,nonce:ajax_obj.nonce},beforeSend:function(){e.addClass("diactive")},complete:function(){notificationButton(),setTimeout(function(){e.removeClass("diactive")},2e4)},success:function(t){t.success?e.closest(".comment").find(".comment-notifications").append('<div class="notification notification_accept">'+t.data+"</div>"):e.closest(".comment").find(".comment-notifications").append('<div class="notification notification_alert">'+t.data+"</div>")}}),t.preventDefault()}),o("#comments").on("click",".comment-reply-link",function(t){a();var e=o(this).closest(".comment");comment_id=e.data("object-id"),o("#cancel-comment-reply-link").css("display","inline"),o("#commentform").find('[name="comment_parent"]').val(comment_id);var n=o("#respond");e.after(n.prop("outerHTML")),n.remove(),t.preventDefault()}),o("#comments").on("click",".comment-edit-link",function(t){a();var e=o(this).closest(".comment");comment_id=e.data("object-id"),comment_text=e.find(".comment-content").html().trim(),o("#cancel-comment-reply-link").css("display","inline");var n=o("#respond");n.find('[name="comment"]').text(comment_text),n.find('[name="comment_id"]').val(comment_id),n.find('[name="comment_action"]').val("edit"),e.after(n.prop("outerHTML")),n.remove(),t.preventDefault()}),o("#comments").on("click",".comment-delete-link",function(t){var e=o(this);form=o("#commentform"),comment=e.closest(".comment"),comment_id=comment.data("object-id"),restoreText=e.data("restore-text"),deleteText=e.data("delete-text"),val="",val=e.hasClass("icon-trash-undo")?"restore":"delete",form.find('[name="comment"]').text(val),form.find('[name="comment_id"]').val(comment_id),form.find('[name="comment_action"]').val(val),o.ajax({type:"POST",url:ajax_obj.url,data:{action:"comments_action",query:form.serialize(),nonce:ajax_obj.nonce},beforeSend:function(){e.addClass("icon-loading")},complete:function(){form.trigger("reset"),e.removeClass("icon-loading"),notificationButton(),n(),e.hasClass("icon-trash-undo")?(e.addClass("icon-trash").removeClass("icon-trash-undo").text(deleteText),comment.removeClass("comment-deleted").addClass("comment-restored fade-in")):(e.addClass("icon-trash-undo").removeClass("icon-trash").text(restoreText),comment.removeClass("comment-restored").addClass("comment-deleted fade-in"))},success:function(t){t.success&&comment.find(".comment-content").html(t.data)}}),t.preventDefault()}),o("#comments").on("click","#cancel-comment-reply-link",function(t){o(this).css("display","none"),n(),t.preventDefault()}),o("#comments").on("click","#submit",function(t){var e=o(this);form=o(this).closest("form"),defaultText=e.data("default-text"),processText=e.data("process-text"),comment_id=form.find('[name="comment_id"]').val(),comment_parent_id=form.find('[name="comment_parent"]').val(),comment_action=form.find('[name="comment_action"]').val(),formDataArray=form.serializeArray(),consentStorage=!1,ready=!0,form.find(".notification").remove(),o("#commentform").find("input[required],textarea[required]").each(function(){0===o(this).val().length&&(o(this).after('<div class="notification notification_warning">'+o(this).data("notification")+"</div>"),notificationButton(),ready=!1)}),ready&&!form.hasClass("processing")&&o.ajax({type:"POST",url:ajax_obj.url,data:{action:"comments_action",query:form.serialize(),nonce:ajax_obj.nonce},beforeSend:function(){e.addClass("icon-loading").text(processText),form.addClass("processing")},complete:function(){form.trigger("reset").removeClass("processing"),e.removeClass("icon-loading").text(defaultText),notificationButton(),n()},success:function(t){if(t.success){if(0<comment_action.length&&0<comment_id.length)o('.comment[data-object-id="'+comment_id+'"]').find(".comment-content").html(t.data).addClass("fade-in");else if("0"===comment_parent_id){0===o("#comments").find(".comment-list").length?o("#comments").append('<ol class="comment-list">'+t.data+"</ol>"):o("#comments").append(t.data)}else{var e=o("#comments").find('.comment[data-object-id="'+comment_parent_id+'"]');children=e.closest(".comment-list-item").find(".children"),0===children.length?e.after('<ol class="children">'+t.data+"</ol>"):children.append(t.data)}console.log("New comment added");for(var n=0;n<formDataArray.length;n++)-1!==o.inArray(formDataArray[n].name,["author","email","url","comment_hash"])&&(i[formDataArray[n].name]=formDataArray[n].value),"wp-comment-cookies-consent"===formDataArray[n].name&&(consentStorage=!0);!0===consentStorage&&localStorage.setItem("commentStorage",JSON.stringify(i)),"undefined"!==i.comment_hash&&m(i.comment_hash)}else o.each(t.data,function(t,e){0!==e.length&&form.find('[name="'+t+'"]').after('<div class="notification notification_warning">'+e+"</div>")})}}),t.preventDefault()})});