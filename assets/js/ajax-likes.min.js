jQuery(document).ready(function(a){var n=localStorage.getItem("likers");container="",button="",count="",n="undefined"===n||null===n?{}:JSON.parse(n),a.each(n,function(n,t){a.each(t,function(t,e){container=a("#primary").find('[data-object-type="'+n+'"][data-object-id="'+t+'"]'),1===container.length&&(button=container.find('[data-key="'+e+'"]'),1===button.length&&(count=parseInt(button.text()),button.removeClass("button-empty").addClass("button-secondary").text(count+1)))})}),a("#primary").on("click",".button-like",function(t){var e=a(this);_value=e.data("key"),container=e.parents(".likes"),object_id=container.data("object-id"),object_type=container.data("object-type"),query={},0!==container.length&&(void 0===n[object_type]&&(n[object_type]={}),query.object_id=object_id,query.object_type=object_type,container.find(".button-like").each(function(t){var e=a(this).data("key");e===_value?a(this).hasClass("button-secondary")?(query[e]="unset",delete n[object_type][object_id]):(query[e]="set",n[object_type][object_id]=_value):a(this).hasClass("button-secondary")&&(query[e]="unset")}),container.hasClass("processing")||a.ajax({url:ajax_obj.url,type:"POST",data:{action:"likers_handler",query:query},beforeSend:function(){container.addClass("processing"),e.addClass("icon-loading")},complete:function(){container.removeClass("processing"),e.removeClass("icon-loading")},success:function(t){t.success&&container.find(".button-like").each(function(t){var e=a(this).data("key");count=parseInt(a(this).text()),e===_value?(a(this).hasClass("button-secondary")?a(this).removeClass("button-secondary").addClass("button-empty").text(count-1):a(this).removeClass("button-empty").addClass("button-secondary").text(count+1),localStorage.setItem("likers",JSON.stringify(n))):a(this).hasClass("button-secondary")&&a(this).removeClass("button-secondary").addClass("button-empty").text(count-1)})}}),t.preventDefault())})});