jQuery(document).ready(function(a){a(".widget").on("click",".button-add-adv-media",function(i){var e=a(this).closest("form");if(control=a(this).closest(".media-widget-control"),t)t.open();else{var t=wp.media.frames.file_frame=wp.media({title:"Select Image",button:{text:"Select Image"},multiple:!1,library:{type:"image"}});t.on("select",function(){var i=t.state().get("selection").first().toJSON();control.find(".image-upload").val(i.url),control.find(".media-image-container").empty(),control.find(".media-image-container").append('<img src="'+i.url+'" class="media-image" alt="Image Preview" style="max-width:100%;margin-bottom:10px" /><span class="media-remove dashicons dashicons-no-alt"></span>'),a(".media-modal:visible").find(".media-modal-close").trigger("click"),e.find('input[name="savewidget"]').val("Save").removeAttr("disabled")}),t.open(),i.preventDefault()}}),a(".sortable-list").sortable({update:function(i,e){var t=[];a(this).find("li.visible").each(function(){t.push(a(this).data("key").trim())}),a(this).next(".sortable-input").val(t.join(",")).trigger("change")}}),a(".dashicons-visibility").on("click",function(i){var e=[];_this=a(this),_this.toggleClass("visible invisible"),_this.parent().toggleClass("visible invisible"),_this.closest(".sortable-list").find("li.visible").each(function(){e.push(a(this).data("key").trim())}),_this.closest(".sortable-list").next(".sortable-input").val(e.join(",")).trigger("change")}),a(document).on("click",".media-remove",function(i){var e=a(this).closest(".media-widget-control");e.find(".media-image-container").empty(),e.find(".image-upload").val("")})});